[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.1.5","content-config-digest","5f0b5b3f61bcb76d","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://JuanitoSebastian.github.io\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[]},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":\"shiki\",\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[null],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"responsiveImages\":false},\"legacy\":{\"collections\":false}}","blog",["Map",11,12],"upd-sockets-and-digital-turntables",{"id":11,"data":13,"body":24,"filePath":25,"assetImports":26,"digest":28,"deferredRender":29},{"title":14,"date":15,"description":16,"mainImage":17,"mainImageAlt":18,"keywords":19},"UDP Sockets & Digital Turntables",["Date","2022-08-09T00:00:00.000Z"],"What type of network traffic is broadcast in a Pro DJ Link network? Investigating the packets sent by Pioneer DJ equipment and creating a Swift application to parse it.","__ASTRO_IMAGE_./imgs/udp_turntables.webp","Close-up of a deejay operating digital turntables",[20,21,22,23],"Networks","Music","Swift","SwiftNIO","import { Image } from 'astro:assets';\nimport BlogPostHead from '../../src/components/blog/BlogPostHead.astro';\nimport BlogPostHeading from '../../src/components/blog/BlogPostHeading.astro';\nimport BlogPostImage from '../../src/components/blog/BlogPostImage.astro';\nimport cdjSetupImage from './imgs/cdj_setup.png';\nimport ioGraphImage from './imgs/io_graph1.png';\nimport mainImage from './imgs/udp_turntables.webp';\n\n\u003CBlogPostHead\n  title=\"UDP Sockets & Digital Turntables\"\n  date=\"2022-08-09\"\n  keywords={['Networks', 'Music', 'Swift', 'SwiftNIO']}\n  mainImage={mainImage}\n  mainImageAlt=\"Close-up of a deejay operating digital turntables\"\n/>\n\nThe nightclub scene is not that different from other industries: it too has seen a massive change from old analog solutions to new digital equipment. There are still some disc jockeys who carry a bag full of vinyls from venue to venue, but the majority of deejays have opted for a much more convenient solution: digital music players. Most nightclubs and music venues have DJ equipment in-house, and the standard setup you will find in nightclubs worldwide is Pioneer CDJ players and a Pioneer DJM mixer. The CDJ is a digital music player capable of playing audio files off from CDs, USB flash drives and SD cards. A deejay typically carries a USB stick with their music library on it. When it's their time to perform, the deejay can just plug the USB flash drive to the CDJ and start playing. Besides the convenience of not having to carry heavy bags full of records, the CDJs offer some fascinating features when connected to a LAN network. CDJ players can share audio files between each other and send useful information like the current BPM (beats per minute) of the current track. The DJM mixer can listen to this information that is broadcast on the network and use it to synchronize audio effects. In a more advanced setup this information can be fed to the lighting and video operators who can use it to synchronize the light show and video effects to match exactly the rhythm of the music that is currently playing. The owner of the Pioneer DJ brand AlphaTheta Corporation calls this technology Pro DJ Link, and they have not released any public documentation on the protocol.\n\nI chose to investigate this topic as part of the university course Data Communication Project. The idea of the course was to do some research about a topic related to computer networks and the write a report of your findings. The aim of my research was to make a packet capture of the network traffic sent by Pioneer DJ equipment and analyze it to see if the mixing done by the DJ was visible in the data. This post is a summary of the [original report](https://drive.google.com/file/d/16tZl3c49iO1IoY9bwgNaKzjF9iTNqisA/view?usp=share_link) I wrote (which is in Finnish).\n\nThe DJ community has done research into the inner workings of the protocol and how the equipment uses it to communicate. [The Deep Symmetry project](https://djl-analysis.deepsymmetry.org/djl-analysis/packets.html) has put together documentation of the different packets the protocol uses to communicate. This resource has been a great help when investigating the topic.\n\n\u003CBlogPostHeading text=\"Packet capture\" />\n\n\u003CBlogPostImage\n  image={cdjSetupImage}\n  alt=\"A top down view of the packet capture setup\"\n  caption=\"Packet capture setup. Two CDJ-2000NXS2 players, a DJM-900NXS2 mixer, a\n    network switch and a laptop.\"\n/>\n\nWireshark was used for the network packet capture. To intercept all the traffic,\nthe DJ equipment was transmitting, I used a network switch with mirroring\nfunctionality. All traffic from ports 1-3 was mirrored to port 5 where my laptop\nwas connected. This way I could see all the transmitted packets, even the ones\nthat were not addressed to the laptop.Â I played a short three track DJ set,\nduring the packet capture. This was to simulate normal DJ equipment usage.\n\n\u003CBlogPostHeading text=\"Results\" />\n\n\u003CBlogPostImage\n  image={ioGraphImage}\n  alt=\"Graph showing amount of UDP packets during the capture\"\n  caption=\"Amount of UDP packets throughout the packet capture\"\n/>\n\nThe performance of the deejay could be seen in the network packet capture. The\nnumber of different UDP packets was clearly affected by what the deejay was\ncurrently doing. In the first graph, we can see that when there is no music\nplaying, the number of UDP 50001 packets hovers around 3-4 packets per second\n(PPS). When player A starts a track, the number of UDP 50001 packets rises to\n5-7 PPS. When player B also starts playing, the number of UDP 50001 packets\nrises to 7-10 PPS. The number of UDP 50002 packets also reflect the actions of\nthe deejay. They tend to peak at the most intense parts of the DJ set, when a\nlot is happening. A sharp peak in UDP 50002 packets can be seen just before 195\nseconds. That was the exact moment when the deejay switched between two songs.\nUDP 50000 packets seem to be only used for an initial handshake and a heartbeat\nsignal.\n\n\u003CBlogPostHeading text=\"Future work\" />\n\nI started working on a [Swift package](https://github.com/JuanitoSebastian/Pro-Dj-Link) for communicating with Pioneer DJ equipment using the Pro DJ Link protocol (PDL). The package can be used to send and receive PDL packets. It's a work-in-progress, and currently it can receive three types of packets: KeepAlive, DeviceAnouncement and Beat. The package uses the SwiftNIO framework to encode and decode the PDL data to and from UDP packets.\n\n\u003CBlogPostHeading text=\"The DJ set and packet capture side by side\" />\n\n\u003Cdiv class=\"blog-post-article-embed video\">\n  \u003Ciframe\n    width=\"560\"\n    height=\"315\"\n    src=\"https://www.youtube.com/embed/MCkAdgy9cAU\"\n    title=\"YouTube video player\"\n    frameborder=\"0\"\n    allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n    allowfullscreen\n  >\u003C/iframe>\n\u003C/div>","content/blog/upd-sockets-and-digital-turntables.mdx",[27],"./imgs/udp_turntables.webp","ee96e7be64889bdd",true]